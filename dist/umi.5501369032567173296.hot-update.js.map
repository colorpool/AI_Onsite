{"version":3,"sources":["umi.5501369032567173296.hot-update.js","src/app.tsx"],"sourcesContent":["globalThis.makoModuleHotUpdate(\n  'src/.umi/umi.ts?hmr',\n  {\n    modules: {},\n  },\n  function (runtime) {\n    runtime._h='307636192791138721';\nruntime.updateEnsure2Map({\"src/.umi/core/EmptyRoute.tsx\":[\"src/.umi/core/EmptyRoute.tsx\"],\"src/.umi/plugin-layout/Layout.tsx\":[\"vendors\",\"src/.umi/plugin-layout/Layout.tsx\"],\"src/.umi/plugin-openapi/openapi.tsx\":[\"vendors\",\"src/.umi/plugin-openapi/openapi.tsx\"],\"src/pages/404.tsx\":[\"p__404\"],\"src/pages/CustomerSuccess/index.tsx\":[\"p__CustomerSuccess__index\"],\"src/pages/agents/index.tsx\":[\"p__agents__index\"],\"src/pages/user/login/index.tsx\":[\"p__user__login__index\"]});;\n  },\n);\n","import { LinkOutlined } from '@ant-design/icons';\nimport type { Settings as LayoutSettings } from '@ant-design/pro-components';\nimport { SettingDrawer } from '@ant-design/pro-components';\nimport type { RequestConfig, RunTimeLayoutConfig } from '@umijs/max';\nimport { history, Link } from '@umijs/max';\nimport React from 'react';\nimport {\n  AvatarDropdown,\n  AvatarName,\n  Footer,\n  Question,\n  SelectLang,\n} from '@/components';\nimport { currentUser as queryCurrentUser } from '@/services/ant-design-pro/api';\nimport defaultSettings from '../config/defaultSettings';\nimport { errorConfig } from './requestErrorConfig';\nimport { TabProvider } from '@/contexts/TabContext';\nimport TabBarWrapper from '@/components/TabBar/TabBarWrapper';\nimport { useMenuState } from '@/hooks/useMenuState';\nimport '@ant-design/v5-patch-for-react-19';\n\nconst isDev = process.env.NODE_ENV === 'development';\nconst loginPath = '/user/login';\n\n/**\n * @see https://umijs.org/docs/api/runtime-config#getinitialstate\n * */\nexport async function getInitialState(): Promise<{\n  settings?: Partial<LayoutSettings>;\n  currentUser?: API.CurrentUser;\n  loading?: boolean;\n  fetchUserInfo?: () => Promise<API.CurrentUser | undefined>;\n}> {\n  const fetchUserInfo = async () => {\n    try {\n      const msg = await queryCurrentUser({\n        skipErrorHandler: true,\n      });\n      return msg.data;\n    } catch (_error) {\n      history.push(loginPath);\n    }\n    return undefined;\n  };\n  // 如果不是登录页面，执行\n  const { location } = history;\n  if (\n    ![loginPath, '/user/register', '/user/register-result'].includes(\n      location.pathname,\n    )\n  ) {\n    const currentUser = await fetchUserInfo();\n    return {\n      fetchUserInfo,\n      currentUser,\n      settings: defaultSettings as Partial<LayoutSettings>,\n    };\n  }\n  return {\n    fetchUserInfo,\n    settings: defaultSettings as Partial<LayoutSettings>,\n  };\n}\n\n// ProLayout 支持的api https://procomponents.ant.design/components/layout\nexport const layout: RunTimeLayoutConfig = ({\n  initialState,\n  setInitialState,\n}) => {\n  // 使用自定义 hook 管理菜单状态\n  const { openKeys, handleOpenChange } = useMenuState();\n\n  return {\n    // 移除actionsRender，不再在顶部显示\n    // actionsRender: () => [\n    //   <Question key=\"doc\" />,\n    //   <SelectLang key=\"SelectLang\" />,\n    // ],\n    // 移除avatarProps，避免重复显示用户头像\n    // avatarProps: {\n    //   src: initialState?.currentUser?.avatar,\n    //   title: <AvatarName />,\n    //   render: (_, avatarChildren) => {\n    //     return <AvatarDropdown>{avatarChildren}</AvatarDropdown>;\n    //   },\n    // },\n    waterMarkProps: {\n      content: initialState?.currentUser?.name,\n    },\n    footerRender: () => <Footer />,\n    onPageChange: () => {\n      const { location } = history;\n      // 如果没有登录，重定向到 login\n      if (!initialState?.currentUser && location.pathname !== loginPath) {\n        history.push(loginPath);\n      }\n    },\n    bgLayoutImgList: [\n      {\n        src: 'https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/D2LWSqNny4sAAAAAAAAAAAAAFl94AQBr',\n        left: 85,\n        bottom: 100,\n        height: '303px',\n      },\n      {\n        src: 'https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/C2TWRpJpiC0AAAAAAAAAAAAAFl94AQBr',\n        bottom: -68,\n        right: -45,\n        height: '303px',\n      },\n      {\n        src: 'https://mdn.alipayobjects.com/yuyan_qk0oxh/afts/img/F6vSTbj8KpYAAAAAAAAAAAAAFl94AQBr',\n        bottom: 0,\n        left: 0,\n        width: '331px',\n      },\n    ],\n    links: [], // 移除OpenAPI文档链接\n    menuHeaderRender: undefined,\n    // 自定义 403 页面\n    // unAccessible: <div>unAccessible</div>,\n    // 增加一个 loading 的状态\n    childrenRender: (children) => {\n      // if (initialState?.loading) return <PageLoading />;\n      return (\n        <TabProvider>\n          <div style={{ display: 'flex', flexDirection: 'column', height: '100vh' }}>\n            <div style={{ position: 'sticky', top: 0, zIndex: 1000, background: '#fff' }}>\n              <TabBarWrapper />\n            </div>\n            <div style={{ flex: 1, padding: 0 }}>\n              {children}\n            </div>\n          </div>\n        </TabProvider>\n      );\n    },\n    // 自定义侧边栏底部内容，包含用户头像和语言切换\n    siderMenuType: 'sub',\n    // 配置菜单属性，实现点击菜单时自动关闭其他菜单\n    menuProps: {\n      mode: 'inline',\n      // 实现手风琴效果：通过 onOpenChange 控制只展开一个子菜单\n      onOpenChange: (openKeys) => {\n        // 只保留最后一个展开的菜单\n        const latestOpenKey = openKeys[openKeys.length - 1];\n        if (latestOpenKey) {\n          // 这里可以通过状态管理来控制 openKeys\n          console.log('展开菜单:', latestOpenKey);\n        }\n      },\n      onClick: (info) => {\n        // 这里可以添加自定义的点击处理逻辑\n        console.log('菜单点击:', info);\n      },\n    },\n    // 添加侧边栏底部自定义渲染\n    menuFooterRender: () => (\n      <div style={{ \n        padding: '16px', \n        borderTop: '1px solid #f0f0f0',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'space-between'\n      }}>\n        <AvatarDropdown>\n          <div style={{ \n            display: 'flex', \n            alignItems: 'center', \n            gap: '8px',\n            cursor: 'pointer',\n            padding: '4px 8px',\n            borderRadius: '6px',\n            transition: 'background-color 0.2s'\n          }}>\n            <AvatarName />\n          </div>\n        </AvatarDropdown>\n        <SelectLang key=\"unique-select-lang\" />\n      </div>\n    ),\n    ...initialState?.settings,\n  };\n};\n\n/**\n * @name request 配置，可以配置错误处理\n * 它基于 axios 和 ahooks 的 useRequest 提供了一套统一的网络请求和错误处理方案。\n * @doc https://umijs.org/docs/max/request#配置\n */\nexport const request: RequestConfig = {\n  baseURL: 'https://proapi.azurewebsites.net',\n  ...errorConfig,\n};\n"],"names":[],"mappings":"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"}